# Selah Web Application

> "ë©ˆì¶”ê³ , ë¬µìƒí•˜ê³ , ê¸°ë¡í•˜ë‹¤"

ê¸°ë„ì œëª©ê³¼ ê¸°ë„ë¬¸ì„ ê¸°ë¡í•˜ê³ , ì‘ë‹µì˜ ê³¼ì •ì„ í™•ì¸í•˜ë©° ë‚˜ë§Œì˜ ê¸°ë„ì˜ ì—¬ì •ì„ ê¸°ë¡í•˜ëŠ” **ê°œì¸ìš© ê¸°ë„ë…¸íŠ¸ ì„œë¹„ìŠ¤** Selahì˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.

### Highlights

- ğŸ” **E2E ì•”í˜¸í™”** - ì„œë²„ëŠ” ì•”í˜¸ë¬¸ë§Œ ì €ì¥, í‰ë¬¸ ì ‘ê·¼ ë¶ˆê°€
- ğŸ—ï¸ **Feature-based ì•„í‚¤í…ì²˜** - ESLintë¡œ ëª¨ë“ˆ ê²½ê³„ ê°•ì œ
- âš¡ **Next.js 16 + React 19** - App Router, Server Components
- ğŸ”„ **TanStack Query** - ì„ ì–¸ì  ìºì‹±, Stale-While-Revalidate

---

## í”„ë¡œì íŠ¸ ê°œìš”

### ì£¼ìš” ê¸°ëŠ¥

- **ê¸°ë„ì œëª© ê´€ë¦¬**: ê¸°ë„ì œëª© CRUD, ì‘ë‹µ ì²´í¬, ì†Œê° ì‘ì„±
- **ê¸°ë„ë¬¸ ê´€ë¦¬**: ê¸°ë„ë¬¸ ì‘ì„± (í•˜ë£¨ ì—¬ëŸ¬ ê°œ ê°€ëŠ¥), íˆìŠ¤í† ë¦¬ ì¡°íšŒ
- **ëŒì•„ë³´ê¸°**: ê³¼ê±° ê¸°ë„ì œëª© ë¦¬ë§ˆì¸ë“œ, ëœë¤/ì£¼ê¸°ì  ì„ ì •
- **í†µê³„**: ì‘ë‹µëœ ê¸°ë„ í†µê³„, íƒ€ì„ë¼ì¸ ë·°
- **ì¸ì¦**: ì†Œì…œ ë¡œê·¸ì¸ (Google, ì¹´ì¹´ì˜¤) + ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸
- **E2E ì•”í˜¸í™”**: 6ìë¦¬ PIN + Server Key ê¸°ë°˜ í´ë¼ì´ì–¸íŠ¸ ì•”í˜¸í™”

---

## Tech Stack

| Category         | Technology     | Version |
|------------------|----------------|---------|
| Framework        | Next.js        | 16.1.1  |
| Language         | TypeScript     | 5.x     |
| UI Components    | shadcn/ui      | -       |
| Styling          | Tailwind CSS   | 4.x     |
| State Management | Zustand        | 5.x     |
| Data Fetching    | TanStack Query | 5.x     |
| API Client       | Ky             | 1.x     |
| Package Manager  | pnpm           | -       |
| Linting          | ESLint         | 9.x     |

## E2E ì•”í˜¸í™” (End-to-End Encryption)

ê¸°ë„ ë°ì´í„°ì˜ í”„ë¼ì´ë²„ì‹œë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ E2E ì•”í˜¸í™”ë¥¼ ì ìš©í•©ë‹ˆë‹¤. ëª¨ë“  ë¯¼ê°í•œ ë°ì´í„°ëŠ” ì„œë²„ë¡œ ì „ì†¡ë˜ê¸° ì „ ë¸Œë¼ìš°ì €ì—ì„œ ì•”í˜¸í™”ë©ë‹ˆë‹¤.

| í•­ëª©         | ë‚´ìš©                                       |
|------------|------------------------------------------|
| **ì•”í˜¸í™” ë°©ì‹** | AES-256-GCM (Web Crypto API)             |
| **í‚¤ ê´€ë¦¬**   | 6ìë¦¬ PIN + Server Key â†’ PBKDF2/HKDFë¡œ í‚¤ íŒŒìƒ |
| **í‰ë¬¸ ë¹„ì €ì¥** | ì„œë²„ëŠ” ì•”í˜¸ë¬¸ë§Œ ì €ì¥/ì²˜ë¦¬, ë³µí˜¸í™” í‚¤ëŠ” ì‚¬ìš©ì ì…ë ¥(PIN)ì— ì˜ì¡´   |

> **ğŸ”’ ìƒì„¸ ì„¤ê³„ ë¬¸ì„œ**: [E2E Encryption Design Specification](./docs/E2E_ENCRYPTION.md)

---

## Architecture

### Feature-based Folder Structure

```
src/
â”œâ”€â”€ app/                  # Next.js App Router (Routing only)
â”œâ”€â”€ components/           # Global components
â”‚   â”œâ”€â”€ ui/               # shadcn/ui (Do not modify)
â”‚   â””â”€â”€ common/           # Project common components
â”œâ”€â”€ features/             # Feature-based modules (member, prayer, etc.)
â””â”€â”€ shared/               # Shared code (api, lib, stores, types, etc.)
```

### ê³„ì¸µ ì˜ì¡´ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Pages/Routes (app/)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Presentation (components/)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Application (hooks/features/)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Infrastructure (shared/api/)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- í•˜ìœ„ ê³„ì¸µì€ ìƒìœ„ ê³„ì¸µì„ importí•  ìˆ˜ ì—†ìŒ
- Feature ê°„ ì§ì ‘ import ê¸ˆì§€ (sharedë¥¼ í†µí•´ì„œë§Œ ê³µìœ )

---

## Technical Highlights

E2E ì•”í˜¸í™” ë„ì…ìœ¼ë¡œ ì¸í•´ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í•´ê²°í•´ì•¼ í–ˆë˜ ê¸°ìˆ ì  ê³¼ì œë“¤ì…ë‹ˆë‹¤.

### 1. E2E UX í”Œë¡œìš°

| ì‹œë‚˜ë¦¬ì˜¤                    | í™”ë©´ ì „í™˜                          | DEK ì²˜ë¦¬                   |
|-------------------------|--------------------------------|--------------------------|
| **ì²« ì„¤ì •** (íšŒì›ê°€ì…/OAuth í›„) | PIN ì„¤ì • â†’ Recovery Key í‘œì‹œ â†’ í™ˆ   | DEK ìƒì„± â†’ ìºì‹œ              |
| **ìºì‹œ ì¡´ì¬** (ê°™ì€ ë¸Œë¼ìš°ì € ì„¸ì…˜)  | ë¡œê·¸ì¸ â†’ í™ˆ (PIN ì…ë ¥ ì—†ìŒ)            | ìºì‹œëœ DEK ì‚¬ìš©               |
| **ìƒˆ ê¸°ê¸°/ì„¸ì…˜ ë§Œë£Œ**          | ë¡œê·¸ì¸ â†’ PIN ì…ë ¥ â†’ í™ˆ               | ì„œë²„ì—ì„œ ë³µì› â†’ ìºì‹œ             |
| **PIN ë¶„ì‹¤**              | Recovery Key ì…ë ¥ â†’ ìƒˆ PIN ì„¤ì • â†’ í™ˆ | Recovery Keyë¡œ ë³µí˜¸í™” â†’ ì¬ì•”í˜¸í™” |

### 2. DEK ìºì‹œ ì •ì±…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Two-Layer Protection                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   [DEK] â”€â”€â–¶ Wrap with [Wrap Key] â”€â”€â–¶ [Encrypted DEK]        â”‚
â”‚                                              â”‚              â”‚
â”‚                                              â–¼              â”‚
â”‚                                      IndexedDB (persistent) â”‚
â”‚                                                             â”‚
â”‚   [Wrap Key] â”€â”€â–¶ sessionStorage (volatile)                  â”‚
â”‚                                                             â”‚
â”‚   Both required to recover DEK                              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

| ì¡°ê±´                                    | DEK ë³µì›       |
|---------------------------------------|--------------|
| IndexedDB âœ“ + sessionStorage âœ“        | âœ… ì¦‰ì‹œ ì‚¬ìš©      |
| IndexedDB âœ“ + sessionStorage âœ— (íƒ­ ë‹«ê¸°) | âŒ PIN ì¬ì…ë ¥ í•„ìš” |
| IndexedDB âœ— (ë¸Œë¼ìš°ì € ë°ì´í„° ì‚­ì œ)             | âŒ PIN ì¬ì…ë ¥ í•„ìš” |

- **ì„¸ì…˜ ì¢…ë£Œ ì‹œ ìë™ ì ê¸ˆ**: sessionStorageëŠ” íƒ­ ë‹«ê¸° ì‹œ ìë™ ì‚­ì œ
- **ìˆ˜ë™ ì ê¸ˆ**: `clearDEKCache()` í˜¸ì¶œë¡œ ì¦‰ì‹œ DEK ì‚­ì œ ê°€ëŠ¥
- **ë¯¼ê° ë°ì´í„° ìµœì†Œ ë…¸ì¶œ**: í‰ë¬¸ì€ React stateì—ë§Œ ì¼ì‹œì ìœ¼ë¡œ ì¡´ì¬, ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ìë™ ì •ë¦¬

### 3. ë°ì´í„° íŒ¨ì¹­/ìºì‹± ì „ëµ

**Query Key ì„¤ê³„ ì›ì¹™**:

```typescript
// ë¦¬ì†ŒìŠ¤ íƒ€ì… ê¸°ë°˜ ê³„ì¸µ êµ¬ì¡°
["prayerTopics"]              // ëª©ë¡
    ["prayerTopics", id]          // ìƒì„¸
    ["prayers", "byTopicId", id]  // ê´€ê³„ ê¸°ë°˜ ì¡°íšŒ
    ["home"]                      // ì§‘ê³„ ë°ì´í„°
```

**Invalidation ì „ëµ**:

| ì•¡ì…˜      | Invalidate ëŒ€ìƒ                              | ì´ìœ             |
|---------|--------------------------------------------|---------------|
| ê¸°ë„ì œëª© ìƒì„± | `prayerTopics`, `home`                     | ëª©ë¡/í†µê³„ ê°±ì‹       |
| ê¸°ë„ì œëª© ìˆ˜ì • | `prayerTopics`, `prayerTopics[id]`, `home` | ìƒì„¸ + ëª©ë¡ ê°±ì‹     |
| ì‘ë‹µ ì²´í¬   | `prayerTopics`, `prayerTopics[id]`, `home` | ìƒíƒœ ë³€ê²½ìœ¼ë¡œ í†µê³„ ì˜í–¥ |
| ê¸°ë„ë¬¸ ì‘ì„±  | `prayers`, `home`                          | ê¸°ë„ íšŸìˆ˜ í†µê³„ ë°˜ì˜   |

- **Stale-While-Revalidate**: ìºì‹œëœ ë°ì´í„° ì¦‰ì‹œ í‘œì‹œ, ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹ 
- **Mutation í›„ ëª…ì‹œì  Invalidation**: Optimistic update ëŒ€ì‹  ì„œë²„ ìƒíƒœ ì‹ ë¢°

### 4. ë³´ì•ˆ ìœ„í˜‘ ëª¨ë¸ (í”„ë¡ íŠ¸ì—”ë“œ ê´€ì )

| ìœ„í˜‘             | í˜„ì¬ ëŒ€ì‘                                 | í•œê³„ ì¸ì •                            |
|----------------|---------------------------------------|----------------------------------|
| **XSS**        | Reactì˜ ê¸°ë³¸ ì´ìŠ¤ì¼€ì´í•‘, ì‚¬ìš©ì ì…ë ¥ ì•”í˜¸í™” í›„ ì €ì¥      | XSS ì„±ê³µ ì‹œ DEK íƒˆì·¨ ê°€ëŠ¥ (E2Eì˜ ë³¸ì§ˆì  í•œê³„) |
| **DEK ë©”ëª¨ë¦¬ ë…¸ì¶œ** | sessionStorage ë¶„ë¦¬ë¡œ IndexedDB ë‹¨ë… ì ‘ê·¼ ì°¨ë‹¨ | DevTools ì ‘ê·¼ ì‹œ í™•ì¸ ê°€ëŠ¥              |
| **ì„¸ì…˜ íƒˆì·¨**      | httpOnly ì¿ í‚¤ (ì„œë²„ ì¸¡), ì„¸ì…˜ ì¢…ë£Œ ì‹œ DEK ìë™ ì‚­ì œ | í™œì„± ì„¸ì…˜ ì¤‘ íƒˆì·¨ ì‹œ ìœ„í—˜                  |

> **XSS ëŒ€ì‘**: CSPëŠ” í˜„ì¬ ë¯¸ì ìš© ìƒíƒœì´ë©°, Reactì˜ ê¸°ë³¸ XSS ë°©ì–´ì™€ ì‚¬ìš©ì ì…ë ¥ì˜ ì•”í˜¸í™” ì €ì¥ì— ì˜ì¡´í•©ë‹ˆë‹¤.

---

## ì£¼ìš” í™”ë©´

| í™”ë©´          | ì„¤ëª…                              |
|-------------|---------------------------------|
| **í™ˆ**       | ì˜¤ëŠ˜ì˜ ê¸°ë„ ì‘ì„± + ëŒì•„ë³¼ ê¸°ë„ ì¹´ë“œ + ê¸°ë„ì œëª© ëª©ë¡ |
| **ê¸°ë„ë¬¸ ì‘ì„±**  | ê¸°ë„ì œëª© ëª©ë¡ ë³´ë©´ì„œ ê¸°ë„ë¬¸ ì‘ì„±              |
| **ê¸°ë„ì œëª© ê´€ë¦¬** | ê¸°ë„ì œëª© ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ                   |
| **ì‘ë‹µëœ ê¸°ë„**  | ë¦¬ìŠ¤íŠ¸/íƒ€ì„ë¼ì¸/í†µê³„ ë·°                   |
| **ì„¤ì •**      | E2E ì•”í˜¸í™” PIN ì„¤ì •, ê³„ì • ê´€ë¦¬           |

---

## Getting Started

### Prerequisites

- Node.js 20+
- pnpm

### Run Locally

```bash
# 1. Clone repository
git clone https://github.com/clroot/selah-web-application.git
cd selah-web-application

# 2. Install dependencies
pnpm install

# 3. Run development server
pnpm dev

# 4. Access application
open http://localhost:3000
```

### Build

```bash
# Build
pnpm build

# Start production server
pnpm start

# Lint & Format
pnpm lint
pnpm format
```

---

## Development Guidelines

ìì„¸í•œ ê°œë°œ ê°€ì´ë“œë¼ì¸ì€ [CLAUDE.md](./CLAUDE.md) ì°¸ì¡°

### í•µì‹¬ ê·œì¹™

- `app/` í´ë”ëŠ” ë¼ìš°íŒ… ì „ìš©
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ `features/` í´ë”ì— ì‘ì„±
- `components/ui/` í´ë”ëŠ” shadcn/ui ì „ìš© (ìˆ˜ì • ê¸ˆì§€)
- Feature ê°„ ì§ì ‘ import ê¸ˆì§€ (ESLint ê·œì¹™ ì ìš©)
- DEKëŠ” ì„œë²„ë¡œ ì „ì†¡ ê¸ˆì§€, IndexedDB + sessionStorage ì´ì¤‘ ë³´í˜¸ë¡œ ìºì‹±

---

## Related Projects

| Project       | Description                | URL                                                                                      |
|---------------|----------------------------|------------------------------------------------------------------------------------------|
| **Selah API** | Kotlin/Spring Boot ë°±ì—”ë“œ API | [https://github.com/clroot/selah-api-server](https://github.com/clroot/selah-api-server) |

---

## License

MIT License
